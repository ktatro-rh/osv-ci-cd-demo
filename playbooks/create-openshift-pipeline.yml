---
- hosts: localhost
  collections:
  - kubernetes.core

  tasks:
  - name: create k8s pipeline task
    kubernetes.core.k8s:
      src: ../openshift-resources/openshift-pipeline-tasks.yml
      state: present
  
  - name: create k8s pipeline task
    kubernetes.core.k8s:
      src: ../openshift-resources/openshift-aap-api-task.yml
      state: present

  - name: create k8s pipeline
    kubernetes.core.k8s:
      definition: "{{ lookup('template', '../openshift-resources/openshift-pipeline.yml') | from_yaml }}"
      state: present

  - name: create k8s pipeline triggers listener
    kubernetes.core.k8s:
      src: ../openshift-resources/openshift-pipeline-triggers-listener.yml
      state: present    

  - name: create k8s pipeline triggers template
    kubernetes.core.k8s:
      src: ../openshift-resources/openshift-pipeline-triggers-template.yml
      state: present

  - name: create k8s pipeline triggers route
    kubernetes.core.k8s:
      src: ../openshift-resources/openshift-pipeline-triggers-route.yml
      state: present    

  - name: create k8s pipeline aap secret
    kubernetes.core.k8s:
      definition: "{{ lookup('template', '../openshift-resources/openshift-secret-aap-creds.yml') | from_yaml }}"
      state: present